openapi: 3.0.3
info:
  title: Utility Rate Quotes API
  description: Provides utility rate quotes (electricity, gas, water, solar) adjusted for weather conditions
  version: 1.0.0
servers:
  - url: http://utilities-quotes.utilities.svc.cluster.local:3002
    description: Kubernetes service
paths:
  /api/rates:
    get:
      summary: Get rate quotes for all cities
      operationId: getAllRates
      tags:
        - Rates
      responses:
        '200':
          description: Rate quotes for all available cities
          content:
            application/json:
              schema:
                type: object
                properties:
                  quotes:
                    type: array
                    items:
                      $ref: '#/components/schemas/CityRateQuote'
                  generatedAt:
                    type: string
                    format: date-time
  /api/rates/base:
    get:
      summary: Get base utility rates (no weather adjustment)
      operationId: getBaseRates
      tags:
        - Rates
      responses:
        '200':
          description: Base rates for all utilities
          content:
            application/json:
              schema:
                type: object
                properties:
                  rates:
                    type: array
                    items:
                      $ref: '#/components/schemas/BaseRate'
                  note:
                    type: string
  /api/rates/{city}:
    get:
      summary: Get rate quote for a specific city
      operationId: getCityRates
      tags:
        - Rates
      parameters:
        - name: city
          in: path
          required: true
          schema:
            type: string
          description: City name (e.g., new-york, london, tokyo)
      responses:
        '200':
          description: Rate quote for the city
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CityRateQuote'
        '404':
          description: City not found or weather unavailable
components:
  schemas:
    BaseRate:
      type: object
      properties:
        utility:
          type: string
          example: electricity
        rate:
          type: number
          example: 0.12
        unit:
          type: string
          example: kWh
    UtilityRate:
      type: object
      properties:
        utility:
          type: string
          example: Electricity
        baseRate:
          type: number
          example: 0.12
        unit:
          type: string
          example: kWh
        weatherAdjustment:
          type: number
          example: 0.04
        adjustedRate:
          type: number
          example: 0.16
        reason:
          type: string
          example: High cooling demand due to heat
    CityRateQuote:
      type: object
      properties:
        city:
          type: string
          example: new-york
        weather:
          type: object
          properties:
            temperature:
              type: number
            conditions:
              type: string
            humidity:
              type: number
        rates:
          type: array
          items:
            $ref: '#/components/schemas/UtilityRate'
        generatedAt:
          type: string
          format: date-time
        validFor:
          type: string
          example: 1 hour
